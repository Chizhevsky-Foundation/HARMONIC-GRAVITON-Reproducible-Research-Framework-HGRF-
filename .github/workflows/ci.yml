- name: Upgrade pip
  run: pip install --upgrade pip

- name: Smoke test — import key libraries
  run: |
    python - <<'PY'
    import sys
    try:
        import numpy as np
        import uproot
        import awkward
        import tensorflow as tf
    except Exception as e:
        print("IMPORT_ERROR:", e)
        raise
    print("imports ok:", np.__version__, uproot.__version__, awkward.__version__, tf.__version__)
    PY

- name: Run lint (flake8) — nonblocking
  run: |
    if command -v flake8 >/dev/null 2>&1; then
      flake8 --max-line-length=120 || true
    else
      echo "flake8 not available"
    fi

- name: Run pytest (if any tests)
  run: |
    if [ -f "pytest.ini" ] || [ -d "tests" ]; then
      pytest -q || true
    else
      echo "No tests found — skipping pytest"
    fi
